# HASS-Google-Cloud-SQL
**Guide on using Google Cloud SQL as a database recorder for Home-assistant.**

[Home-assistant](https://home-assistant.io/) allows you to record and monitor significant volumes of data from sensors within your home. This data is worth keeping as it is a nice resource for [doing data analysis](http://nbviewer.jupyter.org/github/home-assistant/home-assistant-notebooks/tree/master/), where generally speaking the more data the better.

By default [this data is recorded ](https://home-assistant.io/docs/backend/database/)in an SQLite database on the computer running Home-assistant. The computer is typically a raspberry pi with an SD card for memory. Over time the database can become large enough to fill a low capacity SD card. Also pi's are know to occasionally [corrupt their SD card](https://community.home-assistant.io/t/rpi3-third-time-file-corruption/15716), in which case some or all of your data may be lost. Finally if you wish to access the data in a SQLite database you need [access](http://nbviewer.jupyter.org/github/home-assistant/home-assistant-notebooks/blob/master/database-examples.ipynb) to the .db file, which requires you to copy the .db file from the pi and onto the computer (your laptop) where you will do your data analysis.

A solution to this final problem of access to the .db is to setup a database server which you can connect to over the network. Hassio [offers MariaDB server](https://home-assistant.io/addons/mariadb/) for example, although in this case the database is still on the pi (with associated risks). Alternatively if you have access to network storage (NAS) you may wish to setup a database server. This is what I did, running [a MySQL server in Docker on my Synology NAS](https://community.home-assistant.io/t/setting-up-mysql-on-a-synology-nas-docker-container/16253). However if we are serious about long term data storage we should follow the [3-2-1 rule](https://www.acronis.com/en-us/blog/posts/3-2-1-simple-rule-complex-data-protection) and have a backup off-site. Indeed I lost several months work of data from my MySQL db after a problem with Docker. Therefore I investigated cloud storage solutions, which additionally may provide better performance (read times from the db) than my own hosted solution. There are several companies offering databases in the cloud. However I already have an account with Google so decided to investigate their offering.

## Google Cloud SQL##
Google provide an [interesting variety](https://cloud.google.com/products/) of cloud software solutions/products. Their [Cloud SQL](https://cloud.google.com/sql/) product appeared to meet my technical requirements, and is [reasonably priced](https://cloud.google.com/sql/pricing) (particularly compared to purchasing your own NAS!). Once configured, a Cloud SQL database can be accessed as if it were local, and in my limited experience appears to offer faster read times than my own local solution.

### Configuring Cloud SQL ###
Both MySQL and PostgreSQL are offered, and I chose PostgreSQL since I found a useful guide online (Googles own docs being horrendously confusing and convoluted). 
